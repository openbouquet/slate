<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Open Bouquet API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Access</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Open Bouquet API! You can use our API to perform analytics on your data-sources connected to your Open Bouquet server.</p>

<p>We have language bindings in Shell and HTML! You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>To check if you need to authenticate, use this code for example:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With shell, just check the analytics endpoint</span>
curl -X GET <span class="s2">"http://yourserverdomain/v4.2/analytics
</span></code></pre>

<blockquote>
<p>If you need authentication you&rsquo;ll get the following error, where loginURL is the authentication end-point. You can also use the selfLoginURL to be automatically redirected to the original URL after sign-in.</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="nt">"loginURL"</span><span class="p">:</span><span class="s2">"http://yourserverdomain/dev/auth/oauth"</span><span class="p">,</span><span class="w">
</span><span class="nt">"selfLoginURL"</span><span class="p">:</span><span class="s2">"http://yourserverdomain/dev/auth/oauth?client_id=admin_console
&amp;redirect_uri=https://yourserverdomain/dev/v4.2/analytics?style=HTML"</span><span class="p">,</span><span class="w">
</span><span class="nt">"code"</span><span class="p">:</span><span class="mi">401</span><span class="p">,</span><span class="w">
</span><span class="nt">"error"</span><span class="p">:</span><span class="s2">"Auth failed : invalid access_token"</span><span class="p">,</span><span class="w">
</span><span class="nt">"type"</span><span class="p">:</span><span class="s2">"InvalidTokenAPIException"</span><span class="p">,</span><span class="w">
</span><span class="nt">"suppressed"</span><span class="p">:[]}</span><span class="w">
</span></code></pre>

<p>The authentication mechanism depends on the version of OB server you are using.
By default the server authentication is turned-off.</p>

<p>When the authentication is turned on, it uses OAuth2. So you will have to retrieve an authentication token from the authentication server.</p>

<p>Note that by default, if you are not authenticated and you try to access the API, it will throw a 401 error code, with the authentication URL in the error message.</p>

<p>OB expects for the OAuth token to be included in all API requests to the server in a header that looks like the following:</p>

<p><code class="prettyprint">Authorization: Bearer TOKEN</code></p>

<p>For covenience you can also provide the TOKEN as part of the URL, using the <code class="prettyprint">access_token</code> parameter:</p>

<p><code class="prettyprint">GET http://yourserverdomain/dev/v4.2/analytics&amp;access_token=TOKEN</code></p>

<aside class="notice">
In all example you must replace <code>TOKEN</code> with the OAuth2 token.
</aside>

<h1 id="bouquet-concepts">Bouquet Concepts</h1>

<p>This is a brief overview of the various concepts use by Bouquet to organize information.</p>

<h2 id="projects">Projects</h2>

<p>A Project is the top level object that organize data-source model. First a Project defines how to accessing the data-source, through a JDBC url and required authentication. Also the Project defines which part of the data-source will be made available through the API, by listing visible schemas.</p>

<p>A Project also maintains a list of Domain.</p>

<h2 id="domains">Domains</h2>

<p>A Domain is associated with a table or view in the data-source. A Domain can be created dynamically by Open Bouquet, or explicitly by a user. Also a user can modify a dynamic Domain to make it permanent and persist the changes to the model.</p>

<p>A Domain has Dimension and Metric attributes, which are dynamically mapped to the underlying data-source. A user can also modify any existing attribute, or create new ones. Those changes are then persisted in the model.</p>

<h3 id="dimensions">Dimensions</h3>

<p>A Dimension is any non-aggregated expression defined on the Domain.</p>

<h3 id="metrics">Metrics</h3>

<p>A Metric is any expression defined on the Domain. If the metric is an aggregated expression, it will be use as is. If it is not an aggregated expression, nor an analytics expression, it must be possible to apply an aggregation operator like SUM(), &hellip;</p>

<p>Since a Metric can be any expression, it can contain conditional operator like CASE(), combined with an aggregation operator.</p>

<h2 id="relations">Relations</h2>

<p>A Relation defines how to join two Domains. It is defined by a left and right domain, and a predicate expression between the two. It also specify the relation cardinality.</p>

<h2 id="bookmarks">Bookmarks</h2>

<p>A Bookmark is a simple way to create a custom view on your model. From a Domain, you can define a default analysis, select filters, restrict the dimension and metrics usable for pivoting. Bookmarks are also organized on their own inside folders, independently from the Projects - so you can mix in the same folder Bookmarks from different Projects.</p>

<h1 id="analytics-api">Analytics API</h1>

<p>The Analytics API provides you all you need to interact with your data:</p>

<ul>
<li>list available content like Projects, Bookmarks and Domains</li>
<li>query a specific Bookmark or Domain</li>
<li>view dataviz for a specific Bookmark or Domain (as VegaLite output)</li>
<li>explore a Bookmark or Domain scope</li>
<li>create a Bookmark out of a query</li>
</ul>

<aside class="notice">
The Analytics API traits Domain and Bookmark mostly the same. Although they are different kind of object, you can query and view them using the same operations. 
</aside>

<aside class="notice">
In order to discover the API feature in a more friendly way, you can use most of the API methods with style=HTML.
In that mode the API will output some simple HTML that allows interaction through forms. It also provides reference to the API parameters and links to related call you may want to do.
</aside>

<h2 id="list-available-content">List available content</h2>

<blockquote>
<p>This is a very simple example demonstrating how you can get the top level content in your account. In that example you don&rsquo;t need to provide any parameter.</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET 
    --header <span class="s1">'Accept: application/json'</span> 
    --header <span class="s1">'Authorization: Bearer TOKEN'</span>
    <span class="s2">"http://yourserverdomain/v4.2/analytics"</span>
</code></pre>

<p>This method retrieves all the content available for the authenticated user.</p>

<aside class="notice">
This API method support the style=HTML for interactive exploration.
</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://yourserverdomain/dev/v4.2/analytics</code></p>

<aside class="success">
Remember to provide a valid OAuth TOKEN!
</aside>

<h3 id="url-parameters">URL Parameters</h3>

<p>There are no URL parameters for this method.</p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>parent</td>
<td>false, default=/</td>
<td>This is the path of a valid parent container. If the path is not defined, or path=/, it will display the top level content. In order to view a child content, use path=<child.selfRef>. For example in order to list all projects, path=/PROJECTS. This is working like a standard Unix path, for example: /PROJECTS/MyProject/ to list MyProject&rsquo;s domains, or /MYBOOKMARKS/some/folder to list bookmarks and folders. See</td>
</tr>
<tr>
<td>q</td>
<td>false</td>
<td>This is a search string that you can use to filter the result. Multiple tokens can be separated by comma.</td>
</tr>
<tr>
<td>visibility</td>
<td>false, default=ALL</td>
<td>If visibility is ALL, will show all existing content. If visibility is VISIBLE, it will only show objects that have been made explicitly visible.</td>
</tr>
<tr>
<td>style</td>
<td>false, default=HUMAN</td>
<td>defines the output style, check API reference</td>
</tr>
<tr>
<td>envelope</td>
<td>false, default=RESULT</td>
<td>defines the output content, check API reference</td>
</tr>
</tbody></table>

<h3 id="parent-parameter">Parent parameter</h3>

<blockquote>
<p>This is an example demonstrating how you can list the projects available in your account.</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET 
    --header <span class="s1">'Accept: application/json'</span> 
    --header <span class="s1">'Authorization: Bearer TOKEN'</span>
    <span class="s2">"http://yourserverdomain/v4.2/analytics?parent=/PROJECTS"</span>
</code></pre>

<p>The parent parameter is a path. Each section of the path identify a valid container, using either its name or immutable ID.</p>

<p>When browsing the content, you can always use a child <code class="prettyprint">selfRef</code> property to deep dive into it.</p>

<h4 id="top-level-content">Top Level content</h4>

<p>The top level container are immutable: <code class="prettyprint">/PROJECTS</code>, <code class="prettyprint">/MYBOOKMARK</code>, <code class="prettyprint">/SHARED</code></p>

<ul>
<li>PROJECTS lists all available projects for the authenticated user</li>
<li>MYBOOKMARK lists all bookmarks created by the authenticated user</li>
<li>SHARED lists all bookmarks available to the authenticated user</li>
</ul>

<h4 id="project-content">Project content</h4>

<p>In order to list a project content, you can use it&rsquo;s ID or name. Note that the name can change, so if you need to make a persistent reference to the project, it is better to use its ID (remember that by using the style=HUMAN, the API will return objects by name. If you&rsquo;d better list by ID, you can use style=ROBOT. Note that in all case you can use aither name or ID t reference ID). So for example to list your project content you can use either:</p>

<ul>
<li>path=<code class="prettyprint">/PROJECTS/@MyProjectID/</code></li>
<li>path=<code class="prettyprint">/PROJECTS/My Project/</code></li>
</ul>

<p>Note that in order to list a project content, the OB server will request access to the project&rsquo;s database, and update the content dynamically. So the first time you access it may take some delay depending on the database.</p>

<h4 id="bookmarks">Bookmarks</h4>

<p>Both the <code class="prettyprint">/MYBOOKMARK</code> and <code class="prettyprint">/SHARED</code> paths returns bookmarks. The only difference is the bookmark visibility:</p>

<ul>
<li><code class="prettyprint">/MYBOOKMARK</code> only returns the bookmarks that the authenticated user has created </li>
<li><code class="prettyprint">/SHARED</code> returns the bookmarks shared with the authenticated user</li>
</ul>

<p>Both path returns a list of Bookmarks and Folders.</p>

<h3 id="reply">Reply</h3>

<blockquote>
<p>This is the reply from the previous API call for listing available projects</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"parent"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Projects"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list all your Projects"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"parentRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"selfRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/PROJECTS"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FOLDER"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://yourserverdomain/v4.2/analytics?parent=/PROJECTS&amp;style=HUMAN&amp;visibility=ALL&amp;access_token=xxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"upLink"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://yourserverdomain/v4.2/analytics?parent=/&amp;style=HUMAN&amp;visibility=ALL&amp;access_token=xxx"</span><span class="w">
    </span><span class="p">},</span><span class="w">
</span><span class="nt">"children"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo project"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"jdbc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jdbc:postgreql://databasehost:5432/demo"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"parentRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/PROJECTS"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"selfRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/PROJECTS/demo project"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PROJECT"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://yourserverdomain/v4.2/analytics?parent=/PROJECTS/demo project&amp;style=HUMAN&amp;visibility=ALL&amp;access_token=xxx"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"objectLink"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://yourserverdomain/v4.2/rs/projects/576002908294a27bac5a6946?style=HUMAN&amp;access_token=xxx"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>The reply has the following structure.</p>

<p>The <code class="prettyprint">parent</code> node describe the current location of the <code class="prettyprint">parent</code> parameter. For instance you could use it to browse upward, because it provides also <code class="prettyprint">parentRef</code> property (unless it is the root folder).</p>

<p>The <code class="prettyprint">children</code> node is an array of nodes, and it is the content of the <code class="prettyprint">parent</code> node.</p>

<p>Each node has the same structure:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td></td>
</tr>
<tr>
<td>parentRef</td>
<td></td>
</tr>
<tr>
<td>selfRef</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td></td>
</tr>
</tbody></table>

<p>The <code class="prettyprint">link</code> provides you direct navigation into the content hierarchy. If the object type is a container, the link navigate to the content. If the object type cannot be navigated, it is a link to the associated query.</p>

<p>The <code class="prettyprint">objectLink</code> provides a link to the detailed definition of the object. So it will redirect you to a different API depending on the object type. This API is actually the metadata management API that allows you to discover but also modify the model definition.</p>

<aside class="notice">
Navigation in your browser is easier if you install a json prettify plugin :)
</aside>

<h2 id="query-a-bookmark-or-domain">Query a Bookmark or Domain</h2>

<p>This method performs a query on a Bookmark or Domain and return the result as a paginated data table.</p>

<p>The result of the query is automatically stored in the server cache, so it is not a performance problem to perform the same query repeatedly, no need to cache the result on the application side. You can also paginate the results to simplify display. Also it is a good practice to set a <code class="prettyprint">limit</code> on the query, especially for interactive queries. Although the server will paginate the result internally to avoid memory overflow, you may have trouble retrieving the result in JSON. If you really need to extract a large table, prefer using the /export API method which provides streaming results.</p>

<p>It is possible to change the layout of the table using the <code class="prettyprint">data</code> parameter.</p>

<aside class="notice">
This API method support the style=HTML for interactive exploration.
</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://yourserverdomain/v4.2/analytics/&lt;REFERENCE&gt;/query</code></p>

<aside class="success">
Remember to provide a valid OAuth TOKEN!
</aside>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>REFERENCE</td>
<td>true</td>
<td>The identifier of the Bookmark/Domain to retrieve</td>
</tr>
</tbody></table>

<h4 id="bookmark-domain-reference">Bookmark/Domain Reference</h4>

<h3 id="query-parameters">Query Parameters</h3>

<p>Note that you can use the API without providing any additional parameters. In that case the API will compute the default analysis for the reference.
If it is a Bookmark, it will use the bookmark default analysis. In case of a Domain, it will do an no-op analysis.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>groupBy</td>
<td>false</td>
<td>A list of expression to group the result by. This is a multi-valued parameter. Note that the list can be empty, in that case the resulting dataset will be one row as maximum if you provide metrics to compute. Each value must be a valid expression in the Bookmark or Domain scope. See the Expression chapter for reference, but usually you will pass a dimension name you want to group the result by. Alternatively you can use a wildcard (*) as a value to replace the default reference settings. In case of Bookmark it will be replaced by the selected dimensions; in case of Domain it will be replaced by ALL dimensions (so use with care).</td>
</tr>
<tr>
<td>metrics</td>
<td>false</td>
<td>A list of expression to compute. This is a multi-valued parameter. Note that the list can be empty, in that case only the group by is applied (However the query will still perform a group by: if you want to export raw data you need to include an unique key in the list, such as a customer identifier). Each value must be a valid expression in the Bookmark or DOmain scope. See the Expression chapter for reference, but usually you will pass a metric name you want to aggregate the data upon. You can also use any valid expression (usually of numeric value) by combining dimensions, metrics and functions.</td>
</tr>
<tr>
<td>filters</td>
<td>false</td>
<td>A list of conditional expression to filter the data. Note that the list can be empty. Each value must be a valid expression in the Bookmark or Domain scope. See the Expression chapter for reference, but usually you can use any dimension of type conditional (also called segment), or create a simple condition using constant values for instance. You can also use any valid conditional expression by combining dimensions, metrics and functions.</td>
</tr>
<tr>
<td>period</td>
<td>false</td>
<td>the period expression is a shorthand to filter on a timeframe. The expression type is expected to be a date or a timestamp. You can use any valid expression in the Bookmark or Domain scope; usually you can just use a Date dimension (with or without indexing). You can use any function, especially date functions. If this parameter is set, you should provide a timeframe parameters too - see next one for details.</td>
</tr>
<tr>
<td>timeframe</td>
<td>false</td>
<td>the <code class="prettyprint">timeframe</code> parameter is used to define the date or time range of the period. You can either use explicit values (in that case you should provide both lower and upper bounds, thought you can pass a null value to create a semi-open range) or use an alias value or a constant expression. See the <a href="#period-timeframe">Period definition</a> for details.</td>
</tr>
<tr>
<td>compareTo</td>
<td>false</td>
<td>the <code class="prettyprint">compareTo</code> parameter is used in conjunction with the <code class="prettyprint">timeframe</code> parameter to create an automatic comparison between present and past metrics. Setting a value will automatically turn the compare feature on (see <a href="comparing-present-and-past-metrics">compareTo section for details</a>)  You can either use explicit values (in that case you should provide both lower and upper bounds, thought you can pass a null value to create a semi-open range) or use an alias value or a constant expression. Note that the alias values for the <code class="prettyprint">compareTo</code> parameter are different from the <code class="prettyprint">timeframe</code> parameter.</td>
</tr>
<tr>
<td>orderBy</td>
<td>false</td>
<td>a list of sort expression to order the results. Note that the list can be empty. Each value must be a valid <em>sort</em> expression in the Bookmark or Domain scope. A valid <em>sort</em> expression is any expression enclosed by the <code class="prettyprint">DESC()</code> or <code class="prettyprint">ASC()</code> functions.</td>
</tr>
<tr>
<td>limit</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>offset</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>maxRsults</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>startIndex</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>lazy</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>data</td>
<td>false</td>
<td>This parameter defines how to layout the data output. You can use it in conjunction with style and envelope to further customize the reply. See the <a href="#supported-data-layouts">Supported Data Layouts</a> for up to date information.</td>
</tr>
<tr>
<td>style</td>
<td>false</td>
<td>This parameter defines the reply style. The style can modify the response type in order to get a HTML version of the reply. It can also modify the content of the JSON reply by altering the way it references objects. If <code class="prettyprint">style=HUMAN</code> the API will use object names, so you can read and easily understand the output; but on the other side those outputs are fragile to name change so you cannot use them to build an application for instance. If you need the references to be immutable, you need to use <code class="prettyprint">style=ROBOT</code>; but then the output is going to be difficult to read. Note that you can switch between <code class="prettyprint">HUMAN</code> and <code class="prettyprint">ROBOT</code> easily, only the references are modified.</td>
</tr>
<tr>
<td>envelope</td>
<td>false</td>
<td>This parameter defines the content of the reply. You can use it to further customize what information you need, from a full reply including the explicit query as it is interpreted by the API, reply meta-information, header and data; or you can just ask for the data. See <a href="#style-parameter">Style Parameter</a> for details.</td>
</tr>
<tr>
<td>timeout</td>
<td>false</td>
<td>The timeout is in milliseconds. If provided the request execution will be interrupted if exceeding provided timeout. In that case the API will return an ComputingInProgressAPIException. Note that the execution will continue server side, you are only interrupting the request. You can run the same request again (with or without timeout) in order to get the reply (each request is actually pooled, so performing multiple request is actually running the query only once). Note also that the error message contains a QueryID that identifies running query. You can use the /status/QueryID API in order to get information regarding the query (see <a href="#query-status">/status API</a>) or cancel the execution.</td>
</tr>
<tr>
<td>state</td>
<td>false</td>
<td>The state parameter, if provided, is used to apply the state configuration to the current domain/bookmark. It will override any other settings. You can copy an application state - it will compute the corresponding query. Note however that an application can store custom information and do additional computation, that won&rsquo;t be supported by the API.</td>
</tr>
</tbody></table>

<h4 id="default-query">Default Query</h4>

<p>If no parameter is provided, the method will try to compute a default query.</p>

<p>In case of a Bookmark reference, it will compute the Bookmark pre-defined analysis, with default settings.</p>

<h4 id="using-state">Using State</h4>

<p>If a stateID is provided, the API will try to load the State.</p>

<h4 id="defining-query">Defining Query</h4>

<p>Group By and Metrics</p>

<h4 id="filtering">Filtering</h4>

<h4 id="period-amp-timeframe">Period &amp; TimeFrame</h4>

<p>The <code class="prettyprint">period</code> parameter defines the expression to use as the main Period for filtering on <code class="prettyprint">timeframe</code> and also to perform time-over-time comparison (see <a href="#comparing-present-and-past-metrics">Comparing Present and Past Metrics</a>).</p>

<p>Also once you defined the <code class="prettyprint">period</code>, you can then use the <code class="prettyprint">__PERIOD</code> alias in the expression you are using for other parameters (for example <code class="prettyprint">groupby</code> or <code class="prettyprint">orderby</code>; it also work with the <a href="#view-a-bookmark-or-domain">/view API</a> as <code class="prettyprint">x</code>, <code class="prettyprint">y</code>, <code class="prettyprint">color</code>, &hellip; parameters). Note that you can use the alias <code class="prettyprint">__PERIOD</code> also in expression, for example: <code class="prettyprint">MONTHLY(&#39;__PERIOD&#39;)</code> to extract the first day of month of the date - if you want to aggregate results by month for instance.</p>

<p>Note you can also use the <code class="prettyprint">filters</code> parameter to filter on period. This may be useful for special cases, e.g. to define a non-constant period filter&hellip; Also if you use directly the <code class="prettyprint">filter</code> parameter, the <code class="prettyprint">__PERIOD</code> alias is not available.</p>

<p>The <code class="prettyprint">timeframe</code> parameter is an array of values that you can use to filter the data on the <code class="prettyprint">period</code> value.
If the <code class="prettyprint">timeframe</code> is not defined, even if the <code class="prettyprint">period</code> is defined, no filter is applied.
If the <code class="prettyprint">timeframe</code> is defined, you must also define the <code class="prettyprint">period</code> (unless there is a default value available for it)</p>

<p>There are three ways to define the <code class="prettyprint">timeframe</code>: 
 * using explicit date range
 * using an alias
 * using a expression</p>

<h5 id="timeframe-defined-using-explicit-date-range">TimeFrame defined using explicit date range</h5>

<p>In that case you can just provide the date or timestamp value as a formatted string. The API supports the following formats:
 * ISO 8601 timestamp: <code class="prettyprint">yyyy-MM-dd&#39;T&#39;HH:mm:ss.SSSZ</code>
 * ISO 8601 date: <code class="prettyprint">yyyy-MM-dd</code>
 * default Java timestamp format: <code class="prettyprint">EEE MMM dd HH:mm:ss zzz yyyy</code></p>

<h5 id="timeframe-defined-using-an-alias">TimeFrame defined using an alias</h5>

<ul>
<li><code class="prettyprint">__LAST_7_DAYS</code> </li>
<li><code class="prettyprint">__CURRENT_MONTH</code> </li>
<li><code class="prettyprint">__PREVIOUS_MONTH</code></li>
<li><code class="prettyprint">__CURRENT_YEAR</code></li>
</ul>

<h5 id="timeframe-defined-using-an-expression">TimeFrame defined using an expression</h5>

<p>The last method is to define a constant expression. </p>

<h4 id="comparing-present-and-past-metrics">Comparing Present and Past metrics</h4>

<p>The <code class="prettyprint">compareTo</code> parameter accept the same definitions as the <code class="prettyprint">timeframe</code> parameter, except for the aliases. The <code class="prettyprint">compareTo</code> parameter defines a different set of aliases that you can use to easily define relative comparison:</p>

<ul>
<li><code class="prettyprint">__COMPARE_TO_PREVIOUS_PERIOD</code> </li>
<li><code class="prettyprint">__COMPARE_TO_PREVIOUS_MONTH</code> </li>
<li><code class="prettyprint">__COMPARE_TO_PREVIOUS_YEAR</code></li>
</ul>

<p>##### ordering by comparison metric</p>

<h4 id="ordering-the-results">Ordering the results</h4>

<h5 id="sort-expression">Sort Expression</h5>

<h5 id="defining-how-to-sort">defining how to sort</h5>

<p>The easiest way to define a sort order is to use an existing resultset column and provide the position of the column. For example in order to sort on the first column:
<code class="prettyprint">ASC(0)</code>
The position is zero-based, so the first column is 0, the second is 1, etc&hellip;</p>

<aside class="warning">
You cannot use index based orderBy to sort by a comareTo metric. In that case (if the `compareTo` parameter is set), indexes are not taking into account the compareTo columns generated by the query. If you need to sort the result based on a compareTo column you must use the explicit column name (see <a href="#ordering-by-comparison-metric">ordering by comparison metric</a> for details)
</aside>

<h4 id="expressions">Expressions</h4>

<p>The expressions are all evaluated in the current Domain scope (if the reference is a Bookmark, it is its domain).</p>

<p>See the <a href="#expression-reference-guide">&ldquo;Expression Reference Guide&rdquo;</a> for details about how to create expressions.</p>

<h3 id="reply">Reply</h3>

<h4 id="table-header">Table Header</h4>

<h4 id="supported-data-layouts">Supported Data Layouts</h4>

<p>The <code class="prettyprint">data</code> parameter allows to select the output layout.</p>

<table><thead>
<tr>
<th>Data&nbsp;Value</th>
<th>Table Layout</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">TABLE</code></td>
<td>return a matrix, that is an array of row array. A row is an array cell values.</td>
</tr>
<tr>
<td><code class="prettyprint">RECORDS</code></td>
<td>return the table as an array of records. Each row is a record of the form <code class="prettyprint">{&quot;columnName&quot;:value,...}</code></td>
</tr>
<tr>
<td><code class="prettyprint">TRANSPOSE</code></td>
<td>if the query has multiple metrics, transpose the table to create a row for each record/metric. It adds two additional columns <code class="prettyprint">metric</code> and <code class="prettyprint">value</code></td>
</tr>
<tr>
<td><code class="prettyprint">SQL</code></td>
<td>additionally you can ask to retrieve the SQL code for the Query instead of the results</td>
</tr>
<tr>
<td><code class="prettyprint">LEGACY</code></td>
<td>return a JSON compatible with legacy API - this is for internal use only, you should not use it, it will be deprecated soon.</td>
</tr>
</tbody></table>

<p>Note that you can play with the <code class="prettyprint">envelope</code> parameter in order to customize further the reply. For instance if you want to get only the data as the reply, you can add <code class="prettyprint">envelope=DATA</code> parameter. If <code class="prettyprint">data=SQL</code> is used, this will return just the SQL statement. See <a href="#envelope-parameter">Envelope Parameter</a> for details.</p>

<h3 id="examples">Examples</h3>

<h4 id="how-to-compute-metrics-by-month-and-display-it-by-pivot">How to compute metrics by month and display it by pivot?</h4>

<p>How can one create a query that returns the following table:</p>

<table><thead>
<tr>
<th>Country</th>
<th>Total</th>
<th>Jan 2016</th>
<th>Fev 2016</th>
</tr>
</thead><tbody>
<tr>
<td>France</td>
<td>1.000</td>
<td>400</td>
<td>600</td>
</tr>
<tr>
<td>US</td>
<td>2.000</td>
<td>800</td>
<td>1.200</td>
</tr>
</tbody></table>

<aside class="notice">
Note that we are using POST version of /analysis/ID/query for clarity. You can as well use the GET version.
</aside>

<blockquote>
<p>this is the POST payload you have to send to run the query.</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"period"</span><span class="p">:</span><span class="s2">"date"</span><span class="p">,</span><span class="w">
</span><span class="nt">"timeframe"</span><span class="p">:[</span><span class="s2">"2016-01-01"</span><span class="p">,</span><span class="s2">"2016-02-29"</span><span class="p">],</span><span class="w">
</span><span class="nt">"groupBy"</span><span class="p">:[</span><span class="s2">"'Country'"</span><span class="p">],</span><span class="w">
</span><span class="nt">"metrics"</span><span class="p">:[</span><span class="s2">"'Total'"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Let&rsquo;s start with the simple query that returns the total for the selected period (from 2016/01/01 to 2016/02/29):</p>

<table><thead>
<tr>
<th>Country</th>
<th>Total</th>
</tr>
</thead><tbody>
<tr>
<td>France</td>
<td>1.000</td>
</tr>
<tr>
<td>US</td>
<td>2.000</td>
</tr>
</tbody></table>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"period"</span><span class="p">:</span><span class="s2">"Date"</span><span class="p">,</span><span class="w">
</span><span class="nt">"timeframe"</span><span class="p">:[</span><span class="s2">"2016-01-01"</span><span class="p">,</span><span class="s2">"2016-02-29"</span><span class="p">],</span><span class="w">
</span><span class="nt">"groupBy"</span><span class="p">:[</span><span class="s2">"'Country'"</span><span class="p">,</span><span class="s2">"monthly(__PERIOD)"</span><span class="p">],</span><span class="w">
</span><span class="nt">"metrics"</span><span class="p">:[</span><span class="s2">"'Total'"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>We can easily add the monthly total to get the details:</p>

<table><thead>
<tr>
<th>Country</th>
<th>Monthly</th>
<th>Total</th>
</tr>
</thead><tbody>
<tr>
<td>France</td>
<td>2016/01/01</td>
<td>1.000</td>
</tr>
<tr>
<td>US</td>
<td>2016/02/29</td>
<td>2.000</td>
</tr>
</tbody></table>

<aside class="notice">
Note that we are using the `__PERIOD` alias in place of the `Date` dimension, and group by month using the `monthly()` function.
</aside>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"period"</span><span class="p">:</span><span class="s2">"Date"</span><span class="p">,</span><span class="w">
</span><span class="nt">"timeframe"</span><span class="p">:[</span><span class="s2">"2016-01-01"</span><span class="p">,</span><span class="s2">"2016-02-29"</span><span class="p">],</span><span class="w">
</span><span class="nt">"groupBy"</span><span class="p">:[</span><span class="s2">"'Country'"</span><span class="p">,</span><span class="s2">"monthly(__PERIOD)"</span><span class="p">],</span><span class="w">
</span><span class="nt">"metrics"</span><span class="p">:[</span><span class="s2">"'Total'"</span><span class="p">],</span><span class="w">
</span><span class="nt">"orderBy"</span><span class="p">:[</span><span class="s2">"'Country'"</span><span class="p">,</span><span class="s2">"monthly(__PERIOD)"</span><span class="p">],</span><span class="w">
</span><span class="nt">"rollup"</span><span class="p">:[</span><span class="mi">0</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>We can also add the total by country using the rollup feature:</p>

<table><thead>
<tr>
<th>GROUPING_ID</th>
<th>Country</th>
<th>Monthly</th>
<th>Total</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td>France</td>
<td></td>
<td>1.000</td>
</tr>
<tr>
<td></td>
<td>France</td>
<td>2016-01-01</td>
<td>400</td>
</tr>
<tr>
<td></td>
<td>France</td>
<td>2016-02-01</td>
<td>600</td>
</tr>
<tr>
<td>1</td>
<td>US</td>
<td></td>
<td>2.000</td>
</tr>
<tr>
<td></td>
<td>US</td>
<td>2016-01-01</td>
<td>800</td>
</tr>
<tr>
<td></td>
<td>US</td>
<td>2016-02-01</td>
<td>1.200</td>
</tr>
</tbody></table>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"period"</span><span class="p">:</span><span class="s2">"Date"</span><span class="p">,</span><span class="w">
</span><span class="nt">"timeframe"</span><span class="p">:[</span><span class="s2">"2016-01-01"</span><span class="p">,</span><span class="s2">"2016-02-29"</span><span class="p">],</span><span class="w">
</span><span class="nt">"groupBy"</span><span class="p">:[</span><span class="s2">"'Country'"</span><span class="p">,</span><span class="s2">"monthly(__PERIOD)"</span><span class="p">],</span><span class="w">
</span><span class="nt">"metrics"</span><span class="p">:[</span><span class="s2">"'Total'"</span><span class="w">
          </span><span class="p">,</span><span class="s2">"'Total' ON monthly(__PERIOD)=date(\"01/01/16\") as 'JAN 2016'"</span><span class="w">
          </span><span class="p">,</span><span class="s2">"'Total' ON monthly(__PERIOD)=date(\"01/02/16\") as 'FEV 2016'"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Now in order to pivot, we need to add additional metrics for each required column:</p>

<table><thead>
<tr>
<th>Country</th>
<th>Total</th>
<th>Jan 2016</th>
<th>Fev 2016</th>
</tr>
</thead><tbody>
<tr>
<td>France</td>
<td>1.000</td>
<td>400</td>
<td>600</td>
</tr>
<tr>
<td>US</td>
<td>2.000</td>
<td>800</td>
<td>1.200</td>
</tr>
</tbody></table>

<h2 id="query-status">Query Status</h2>

<p>This method provides the status of a running query.</p>

<h2 id="export-a-bookmark-or-domain">Export a Bookmark or Domain</h2>

<p>This method is similar to the /query API but will stream the result as a data file instead of returning a JSON reply.</p>

<p>It support several format for export: CSV, XLS, XLSX</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://yourserverdomain/v4.2/analytics/{REFERENCE}/export/{filename}</code></p>

<aside class="success">
Remember to provide a valid OAuth TOKEN!
</aside>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>REFERENCE</td>
<td>true</td>
<td>The identifier of the Bookmark/Domain to retrieve</td>
</tr>
<tr>
<td>filename</td>
<td>true</td>
<td>The filename can be defined here to provide a filename when the user will be prompted to save the file. The name part is optional, but the file extension must be provided to define the format of the export</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Filename&nbsp;extension</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>.csv</td>
<td>Comma separated file with an header for the columns</td>
</tr>
<tr>
<td>.xls</td>
<td>Excel file format</td>
</tr>
<tr>
<td>.xlsx</td>
<td>Excel file format</td>
</tr>
</tbody></table>

<h2 id="view-a-bookmark-or-domain">View a Bookmark or Domain</h2>

<h2 id="api-output-parameters">API output parameters</h2>

<p>All API methods returning data accept some parameters to modify the output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>style</td>
<td>false</td>
<td>defines the output style. Values can be HUMAN, ROBOT, HTML or LEGACY. See next chapter for details</td>
</tr>
<tr>
<td>envelope</td>
<td>false</td>
<td>defines the output content. Values can be ALL, RESULT, DATA</td>
</tr>
</tbody></table>

<h3 id="style-parameter">Style parameter</h3>

<p>This parameter defines the reply style.</p>

<table><thead>
<tr>
<th>Style&nbsp;Value</th>
<th>Table Layout</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">HUMAN</code></td>
<td>When the <code class="prettyprint">style</code> parameter is set to <code class="prettyprint">HUMAN</code>, the API will use name as object reference. This allows the reply to be easily readable by human. The drawback is that the information is fragile to name change, so you shouldn&rsquo;t use it statically in your apps.</td>
</tr>
<tr>
<td><code class="prettyprint">ROBOT</code></td>
<td>When the <code class="prettyprint">style</code> parameter is set to <code class="prettyprint">ROBOT</code>, the API will use immutable identifier as object reference. That makes the information robust to name change, but you may have hard time deciphering it (unless you are NEO).</td>
</tr>
<tr>
<td><code class="prettyprint">HTML</code></td>
<td>This special style modify the output to be a static HTML page, instead of the regular JSON data feed. This is mainly used for exploring the API in a friendly way (think of it as a custom swagger UI). The HTML pages are actually good old forms that you can use also to input parameters and quickly see the result. It also provides some additional shortcut links to related queries you may need.</td>
</tr>
</tbody></table>

<h3 id="envelope-parameter">Envelope parameter</h3>

<p>This parameter defines the content of the reply. You can use it to further customize what information you need, from a full reply including the explicit query as it is interpreted by the API, reply meta-information, header and data; or you can just ask for the data.</p>

<table><thead>
<tr>
<th>Envelope&nbsp;Value</th>
<th>Table Layout</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">ALL</code></td>
<td>This the default. It will return the full reply, including the original query as evaluated by the API (so it can be different than the query you send, because it will list all implicit settings and override), and the complete result including meta informations, table header and the data.</td>
</tr>
<tr>
<td><code class="prettyprint">RESULT</code></td>
<td>This setting will only return the result part</td>
</tr>
<tr>
<td><code class="prettyprint">DATA</code></td>
<td>This setting will only return the data with no additional information.</td>
</tr>
</tbody></table>

<h1 id="model-api">Model API</h1>

<p>The Model API allows you to configure the meta-model, including project creation, customization of domains, creation of dimensions and metrics, configuring hierarchies and indexing, etc&hellip;</p>

<h1 id="management-api">Management API</h1>

<p>This is a set of APIs to manage the OB server.</p>

<h1 id="expression-reference-guide">Expression Reference Guide</h1>

<p>This part describes how to write Expression and the available Functions to use.</p>

<h2 id="constant-expression">Constant Expression</h2>

<table><thead>
<tr>
<th>Constant type</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td>Numerical</td>
<td>123.4</td>
</tr>
<tr>
<td>Text</td>
<td>&ldquo;Hello world&rdquo;</td>
</tr>
<tr>
<td>Date</td>
<td>DATE(&ldquo;DD/MM/YY&rdquo;)<br><i>note that you cannot change the date format when defining a constant</i></td>
</tr>
</tbody></table>

<aside class="success">
String constants are enclose using <b>double quotes</b>, be careful!
</aside>

<h2 id="referencing-objects">Referencing objects</h2>

<p>Expression allows you to create references to a model object and to perform operations on their underlying values.</p>

<p>To create a reference, you can use two syntax:</p>

<ul>
<li>Shortand</li>
<li>Explicit</li>
</ul>

<blockquote>
<p>examples of referencing objects using identifiers</p>
</blockquote>
<pre class="highlight plaintext"><code>
// always enclose the identifier in single-quotes

// using a named identifier 
// without specifying the object type, 
// so the scope will manage the order
// in case of conflicts
'this is a identifier name'

// using an ID
@'someID'

// using a typed name, 
// in case of collision
[dimension:'this is a dimension']

// using a typed ID 
// only the ID is enclosed, not the type
@bookmark:'someBookmarkID'
</code></pre>

<p>Important: The resolution of an object identifier is case sensitive, and the identifier must be enclosed in simple quotes.</p>

<aside class="success">
Identifiers must be enclosed between <b>single quotes</b>, be careful!
</aside>

<table><thead>
<tr>
<th>Object type</th>
<th>Shorthand</th>
<th>Explicit</th>
</tr>
</thead><tbody>
<tr>
<td>Column</td>
<td>#&lsquo;CUSTOMER_NAME&rsquo;</td>
<td>[col:&#39;CUSTOMER_NAME&rsquo;] or @col:&#39;CUSTOMER_NAME&rsquo;</td>
</tr>
<tr>
<td>Object by name<br>(Domain, Dimension, Metric or Relation)</td>
<td>&#39;Name&rsquo;</td>
<td>[dimension:&#39;Name&rsquo;] or @metric:&#39;Name&rsquo;<br><i>note: using the explicit form can be useful to resolve name collision</td>
</tr>
<tr>
<td>Object by ID<br>(Domain, Dimension, Metric or Relation)</td>
<td>@&#39;someID&rsquo;</td>
<td>[id:&#39;someID&rsquo;]</td>
</tr>
<tr>
<td>Parameter</td>
<td>$&#39;M0&rsquo;</td>
<td>[param:&#39;M0&rsquo;]</td>
</tr>
</tbody></table>

<h2 id="composing-expression">Composing Expression</h2>

<p>If an expression is an Object, it is usually possible to compose it with expression valid in the target object scope.</p>

<p>For example if the scope is the <code class="prettyprint">Sales</code> domain, you can create the following expression to resolve the country of the customer: </p>

<p><code class="prettyprint">&#39;customer&#39;.&#39;address&#39;.&#39;country&#39;.&#39;name&#39;</code></p>

<p>You can also use the special expression <code class="prettyprint">$self</code> to reference the domain itself, for example: </p>

<p><code class="prettyprint">&#39;customer&#39;.&#39;address&#39;</code></p>

<h2 id="naming-expressions">Naming expressions</h2>

<p>Since version 4.2.2, Bouquet server allows us to give a name to expressions. Just use the AS keyword in the expression editor:</p>

<p>&#39;metric1&rsquo; + &#39;metric2&rsquo; AS &#39;sum_of_both_metrics&rsquo;</p>

<p>This can be useful when using custom expressions to compute an analysis. The resulting column in the data-table will have the expression&rsquo;s name. Note however that if you define a dimension or a metric, the dimension or metric given name will take precedence over the expression&rsquo;s name.</p>

<h2 id="operators">Operators</h2>

<table><thead>
<tr>
<th>Operator</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>expr1 &#124;&#124; expr2</td>
<td>Logical</td>
<td>OR logical operator</td>
</tr>
<tr>
<td>expr1 &amp;&amp; expr2</td>
<td>Logical</td>
<td>AND logical operator</td>
</tr>
<tr>
<td>expr1 LIKE expr2</td>
<td>Logical</td>
<td>Search for a specified pattern in a column</td>
</tr>
<tr>
<td>expr1 = expr2</td>
<td>Comparison</td>
<td>Checks if expr1 is equal to expr2</td>
</tr>
<tr>
<td>expr1 &gt; expr2</td>
<td>Comparison</td>
<td>Greater comparator</td>
</tr>
<tr>
<td>expr1 &gt;= expr2</td>
<td>Comparison</td>
<td>Greater or equal comparator</td>
</tr>
<tr>
<td>expr1 &lt; expr2</td>
<td>Comparison</td>
<td>Less comparator</td>
</tr>
<tr>
<td>expr1 &lt;= expr2</td>
<td>Comparison</td>
<td>Less or equal comparator</td>
</tr>
<tr>
<td>expr1 != expr2</td>
<td>Comparison</td>
<td>Not equal comparator</td>
</tr>
<tr>
<td>expr1 RLIKE expr2</td>
<td>Comparison</td>
<td>Executes a &ldquo;LIKE&rdquo; comparison using a regexp expression</td>
</tr>
<tr>
<td>n1 % n2</td>
<td>Math</td>
<td>Modulo operator</td>
</tr>
<tr>
<td>n1 + n2</td>
<td>Math</td>
<td>Addition operator</td>
</tr>
<tr>
<td>n1 - n2</td>
<td>Math</td>
<td>Subtraction operator</td>
</tr>
<tr>
<td>n1 *n2</td>
<td>Math</td>
<td>Multiplication operator</td>
</tr>
<tr>
<td>n1 / n2</td>
<td>Math</td>
<td>Division operator</td>
</tr>
<tr>
<td>n1 ** n2</td>
<td>Math</td>
<td>Exponential operator (n1 to n2th power)</td>
</tr>
</tbody></table>

<h2 id="math-functions">Math functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>ABS(n)</td>
<td>Absolute value of number</td>
</tr>
<tr>
<td>ACOS(n)</td>
<td>Arc cosine of n</td>
</tr>
<tr>
<td>ASIN(n)</td>
<td>Arc sine of n</td>
</tr>
<tr>
<td>ATAN(n)</td>
<td>Arc tangent of n</td>
</tr>
<tr>
<td>COS(n)</td>
<td>Cosine of n</td>
</tr>
<tr>
<td>CEIL(n)</td>
<td>Smallest integer value that is greater than or equal to a number.</td>
</tr>
<tr>
<td>COSH(n)</td>
<td>Hyperbolic cosine of n</td>
</tr>
<tr>
<td>DEGREES(n)</td>
<td>Argument converted to degrees of n</td>
</tr>
<tr>
<td>EXP(n1,n2)</td>
<td>Exponential (n1 to n2th power)</td>
</tr>
<tr>
<td>FLOOR(n)</td>
<td>Largest integer value that is less than or equal to a number.</td>
</tr>
<tr>
<td>GREATEST(expr1, expr2, &hellip;)</td>
<td>Greatest value in a list of expressions</td>
</tr>
<tr>
<td>LEAST(expr1, expr2, &hellip;)</td>
<td>Smallest value in a list of expressions</td>
</tr>
<tr>
<td>LN(n)</td>
<td>Natural Log of n, where n&gt;0</td>
</tr>
<tr>
<td>LOG(n1,n2)</td>
<td>Log of n1, base n2</td>
</tr>
<tr>
<td>MINUS(n1,n2)</td>
<td>Difference between n1 and n2</td>
</tr>
<tr>
<td>PI()</td>
<td>PI number of n</td>
</tr>
<tr>
<td>POWER(n1,n2)</td>
<td>n1 raised to the n2th power.</td>
</tr>
<tr>
<td>RADIANS(n)</td>
<td>Argument converted to radians of n</td>
</tr>
<tr>
<td>RAND()</td>
<td>Generate a random value</td>
</tr>
<tr>
<td>ROUND(n,[p])</td>
<td>Number n rounded to a given (optionnal) precision p. p can be negative, to cause p digits left of the decimal point of the value n to become zero.</td>
</tr>
<tr>
<td>SIGN(n)</td>
<td>Sign of a number (-1 or 1)</td>
</tr>
<tr>
<td>SIN(n)</td>
<td>Sine of n</td>
</tr>
<tr>
<td>SINH(n)</td>
<td>Hyperbolic Sine of n</td>
</tr>
<tr>
<td>SQRT(n)</td>
<td>Square root of n</td>
</tr>
<tr>
<td>SUBSTRACTION(n1,n2)</td>
<td>Substract n2 from n1</td>
</tr>
<tr>
<td>TAN(n)</td>
<td>Tangent of n</td>
</tr>
<tr>
<td>TANH(n)</td>
<td>Hyperbolic tangent of n</td>
</tr>
<tr>
<td>TRUNCATE(n1,n2)</td>
<td>n1 truncated to n2 decimal places.</td>
</tr>
</tbody></table>

<h2 id="date-functions">Date functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>ADD_MONTHS(date,num_months)</td>
<td>Returns date + num_months (can be negative)</td>
</tr>
<tr>
<td>CURRENT_DATE()</td>
<td>Get the current system date</td>
</tr>
<tr>
<td>CURRENT_TIMESTAMP()</td>
<td>Get the current system timestamp</td>
</tr>
<tr>
<td>DAILY(timestamp)</td>
<td>convert the timestamp into a date</td>
</tr>
<tr>
<td>DATE_ADD(date1,number,period)</td>
<td>Add to date1 the number of period (unit in SECOND,MINUTE,HOUR,DAY,MONTH,YEAR)<br>Note: Adding two dates is not possible</td>
</tr>
<tr>
<td>DATE_INTERVAL(date1,date2,period)</td>
<td>Compute the difference btw date1 and date2 in a particular period (unit in SECOND,MINUTE,HOUR,DAY)</td>
</tr>
<tr>
<td>DATE_SUB(date1,date2)</td>
<td>Remove date2 from date1</td>
</tr>
<tr>
<td>DATE_SUB(date1,number,period)</td>
<td>Remove from date1 the number of period (unit in SECOND,MINUTE,HOUR,DAY,MONTH,YEAR)</td>
</tr>
<tr>
<td>DATE_TRUNCATE(date,format)</td>
<td>Truncate the date (it can be a Date or a Timestamp) depending on the format constant string:<br>if format=&ldquo;day&rdquo; then the result is the Date part of date (excluding the time)<br>if format=&ldquo;week&rdquo; then the result is the first day of the week containing date<br>if format=&ldquo;month&rdquo; then the result is the first day of the month containing date<br>if format=&ldquo;quarter&rdquo; then the result is the first day of the quarter containing date<br>if format=&ldquo;year&rdquo; then the result is the first day of the year containing date<br><br>Note: this is useful to perform weekly, monthly, quarterly or yearly analysis (you can also use the shortcut functions DAILY(), WEEKLY(), MONTHLY(), QUARTERLY() or YEARLY())</td>
</tr>
<tr>
<td>DAY(date)</td>
<td>Extract the day of the month from date</td>
</tr>
<tr>
<td>DAY_OF_WEEK(date)</td>
<td>extract the day of the week date, between 1 and 7. Day 1 is sunday</td>
</tr>
<tr>
<td>DAY_OF_YEAR(date)</td>
<td>Extract the day of the year from the date</td>
</tr>
<tr>
<td>FROM_EPOCH(n)</td>
<td>Return a timestamp based on a numeric field representing the number of seconds since 01-01-1970.</td>
</tr>
<tr>
<td>HOUR(date)</td>
<td>Extract the hour from date</td>
</tr>
<tr>
<td>MINUTE(date)</td>
<td>Extract minutes from date</td>
</tr>
<tr>
<td>MONTHLY(date or timestamp)</td>
<td>return the first day of month from the date</td>
</tr>
<tr>
<td>MONTHS(date)</td>
<td>Extract the month in the year from date</td>
</tr>
<tr>
<td>MONTHS_BETWEEN(date1,date2)</td>
<td>Number of months between d1 and d2</td>
</tr>
<tr>
<td>QUARTERLY(date or timestamp)</td>
<td>return the first day of the quarter from the date</td>
</tr>
<tr>
<td>SECOND(date)</td>
<td>Extract seconds from date</td>
</tr>
<tr>
<td>TO_DATE(timestamp)</td>
<td>Convert a timestamp to a date</td>
</tr>
<tr>
<td>TO_DATE(text, format)</td>
<td>Convert a text to a date with a specific format</td>
</tr>
<tr>
<td>TO_EPOCH(timestamp)</td>
<td>Return a numeric value based on a timestamp field representing the number of seconds since 01-01-1970.</td>
</tr>
<tr>
<td>TO_TIMESTAMP(date)</td>
<td>Convert a timestamp to a date</td>
</tr>
<tr>
<td>TO_TIMESTAMP(text, format)</td>
<td>Convert a text to a timestamp with a specific format</td>
</tr>
<tr>
<td>WEEKLY(date or timestamp)</td>
<td>return the first day of the week from the date</td>
</tr>
<tr>
<td>YEAR(date)</td>
<td>Extract the year from date</td>
</tr>
<tr>
<td>YEARLY(date or timestamp)</td>
<td>return the first day of the year from the date</td>
</tr>
</tbody></table>

<h2 id="text-functions">Text functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>CONCAT(s1,s2)</td>
<td>Concatenate Text1 and text2</td>
</tr>
<tr>
<td>LENGTH(s)</td>
<td>Length of a text</td>
</tr>
<tr>
<td>LOWER(s)</td>
<td>Lower case text</td>
</tr>
<tr>
<td>MD5(string)</td>
<td>Calculates the MD5 hash of string, returning the result in hexadecimal</td>
</tr>
<tr>
<td>POSITION(s1, s2)</td>
<td>Returns the position of s2 within s1 starting from index 1, 0 otherwise</td>
</tr>
<tr>
<td>REPLACE(text, from, to)</td>
<td>Replace within the first text from text with to text</td>
</tr>
<tr>
<td>REVERSE(string)</td>
<td>Returns reversed string</td>
</tr>
<tr>
<td>SPLIT_PART(string, delimiter, position)</td>
<td>Splits string on delimiter and return the given field (counting from one)</td>
</tr>
<tr>
<td>SUBSTRING(text,n1 [,n2])</td>
<td>Substring of s, starting from index n1 optionally ending at index n2</td>
</tr>
<tr>
<td>TRANSLATE(text, from, to)</td>
<td>Replace within the first text each single char specified in from text withto the corresponding char specified in to</td>
</tr>
<tr>
<td>TO_CHAR(number)</td>
<td>Convert a number to a text</td>
</tr>
<tr>
<td>TO_CHAR(date or timestamp, format)</td>
<td>Convert a date or timestamp to a text with a specific format. You can use any format supported by the underlying data-source. Check next § for a quick refernce guide</td>
</tr>
<tr>
<td>UPPER(s)</td>
<td>Uppercase text</td>
</tr>
</tbody></table>

<h3 id="date-formatting">Date Formatting</h3>

<p>This is just a quick reference guide for usual formats. You can use any format supported by the underlying data-source. </p>

<table><thead>
<tr>
<th>Format</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>YYYY</td>
<td>4 digits year, e.g. 2016</td>
</tr>
<tr>
<td>YYY</td>
<td>3 digits year, e.g. 016</td>
</tr>
<tr>
<td>YY</td>
<td>2 digits year, e.g. 16</td>
</tr>
<tr>
<td>Y</td>
<td>1 digit year, e.g. 6</td>
</tr>
<tr>
<td>MONTH</td>
<td>Month name (uppercase)</td>
</tr>
<tr>
<td>MON</td>
<td>abbreviated month name</td>
</tr>
<tr>
<td>MM</td>
<td>month number (01-12)</td>
</tr>
<tr>
<td>DAY</td>
<td>name of the day</td>
</tr>
<tr>
<td>DDD</td>
<td>Day of the year (1-366)</td>
</tr>
<tr>
<td>DD</td>
<td>Day of the month (1-31)</td>
</tr>
<tr>
<td>D</td>
<td>Day of week (1-7)</td>
</tr>
</tbody></table>

<h2 id="regex-functions">Regex functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Available</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>REGEXP_COUNT(string, regexp)</td>
<td>RedShift only</td>
<td>Counts the number of occurrence of the regexp within the string</td>
</tr>
<tr>
<td>REGEXP_INSTR(string, regexp)</td>
<td>RedShift &amp; Oracle</td>
<td>Returns the position of the first occurrence found of the searched regexp within the string</td>
</tr>
<tr>
<td>REGEXP_REPLACE(string, regexp, replace)</td>
<td>All but MySQL</td>
<td>Replace substring matching a POSIX regular expression</td>
</tr>
<tr>
<td>REGEXP_SUBSTR(string, regexp)</td>
<td>All but MySQL</td>
<td>Extract substring matching POSIX regular expression</td>
</tr>
</tbody></table>

<h2 id="json-functions">JSON functions</h2>

<p>These functions are only supported by the Redshift plugin.</p>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>JSON_ARRAY_LENGTH (&#39;json string&rsquo;)</td>
<td>Returns the number of elements in the outer array of a JSON string</td>
</tr>
<tr>
<td>JSON_EXTRACT_ARRAY_ELEMENT_TEXT(&#39;json string&rsquo;, pos)</td>
<td>Returns a JSON array element in the outermost array of a JSON string, using a zero-based index.</td>
</tr>
<tr>
<td>JSON_EXTRACT_PATH_TEXT(json string&rsquo;, &#39;path_elem&rsquo; [,&#39;path_elem&rsquo;[, …]])</td>
<td>Returns the value for the key:value pair referenced by a series of path elements in a JSON string. The JSON path can be nested up to five levels deep.</td>
</tr>
</tbody></table>

<h2 id="aggregate-functions">Aggregate functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>COUNT(*) or COUNT([DISTINCT] expr)</td>
<td>Count the no of rows returned or no of rows returned by expr</td>
</tr>
<tr>
<td>AVG([DISTINCT] value expr)</td>
<td>Average value of ‘n&rsquo; ignoring NULL</td>
</tr>
<tr>
<td>DISTINCT(expr)</td>
<td>Get distinct values returned by expr</td>
</tr>
<tr>
<td>MAX(value expr)</td>
<td>Maximum value within an expression</td>
</tr>
<tr>
<td>MEDIAN([DISTINCT] n)</td>
<td>Median of n, ignoring NULLs.</td>
</tr>
<tr>
<td>MIN(value expr)</td>
<td>Minimum value within an expression</td>
</tr>
<tr>
<td>SUM(value expr)</td>
<td>Sum an expression</td>
</tr>
</tbody></table>

<p>VARIANCE([DISTINCT] n) | Variance of n, ignoring NULLs</p>

<h3 id="windowing-analytics-functions">Windowing / Analytics functions</h3>

<p>You can apply an operator on a group of rows using the windowing syntax:</p>

<ul>
<li>Use the partition expression to partition the query result set into groups based on one or more value expression. If you omit this clause, then the function treats all rows of the query result set as a single group</li>
<li>Use the order by expression to specify how data is ordered within a partition</li>
</ul>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>AVG([DISTINCT] value expr, [partition expr], [order by expr])</td>
<td>Average value of ‘n&rsquo; ignoring NULL</td>
</tr>
<tr>
<td>DISTINCT(expr)</td>
<td>Get distinct values returned by expr</td>
</tr>
<tr>
<td>MAX(value expr, [partition expr], [order by expr])</td>
<td>Maximum value within an expression</td>
</tr>
<tr>
<td>MEDIAN([DISTINCT] n)</td>
<td>Median of n, ignoring NULLs.</td>
</tr>
<tr>
<td>MIN(value expr, [partition expr], [order by expr])</td>
<td>Minimum value within an expression</td>
</tr>
<tr>
<td>RANK([partition expr], [order by expr])</td>
<td>Returns the rank of a value in apartition expression. Same values within a partition have the same rank and the partition can be ordered</td>
</tr>
<tr>
<td>ROW_NUMBER([partition expr], [order by expr])</td>
<td>Returns a number to each row to which it is applied in a partition expression. The number returned is unique within its partition and the partition can be ordered</td>
</tr>
<tr>
<td>SUM(value expr, [partition expr], [order by expr])</td>
<td>Sum an expression</td>
</tr>
</tbody></table>

<h2 id="numeric-functions">Numeric functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>TO_INTEGER(expr)</td>
<td>Convert a text, or a numeric field to an integer</td>
</tr>
<tr>
<td>TO_NUMBER(expr)</td>
<td>Convert a text, an integer or a numeric field to a float</td>
</tr>
<tr>
<td>TO_NUMBER(expr,size,precision)</td>
<td>Convert a text, an integer or a numeric field to a specific numeric format</td>
</tr>
</tbody></table>

<h2 id="logical-functions">Logical functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>CASE(condition1,then1,&hellip;,[else])</td>
<td>Group the data into sub-sets</td>
</tr>
<tr>
<td>ISNULL(expr)</td>
<td>Expr is null logical function</td>
</tr>
<tr>
<td>NOT(expr1, expr2)</td>
<td>Expr1 not equal to expr2 logical operator</td>
</tr>
<tr>
<td>NULLIF(expr1, expr2)</td>
<td>Returns the first expression if the two expressions aren&rsquo;t equal or a null value if the two expressions are equal</td>
</tr>
</tbody></table>

<h2 id="miscellaneous-functions">Miscellaneous functions</h2>

<table><thead>
<tr>
<th>Function</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>EXISTS(expr)</td>
<td>Checks that a sub condition is matched. The EXISTS condition is considered &ldquo;to be met&rdquo; if the subquery returns at least one row.</td>
</tr>
<tr>
<td>LPAD(text,length,text)</td>
<td>Left pad with the text the text to specified length</td>
</tr>
<tr>
<td>LTRIM(text,[character])</td>
<td>Remove leading characters from the text. By default, the character to remove is a whitespace</td>
</tr>
<tr>
<td>RPAD(text,length,text)</td>
<td>Right pad with the text the text to specified length</td>
</tr>
<tr>
<td>RTRIM(text,[character])</td>
<td>Remove trailing characters from the text. By default, the character to remove is a whitespace</td>
</tr>
<tr>
<td>TRIM(text, [character])</td>
<td>Remove leading and trailing characters from the text. By default, the character to remove is a whitespace</td>
</tr>
</tbody></table>

          <h1 id="errors">Errors</h1>

<aside class="notice">This error section is stored in a separate file in `includes/_errors.md`. Slate allows you to optionally separate out your docs into many files&hellip;just save them to the `includes` folder and add them to the top of your `index.md`&rsquo;s frontmatter. Files are included in the order listed.</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request sucks</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>
<tr>
<td>418</td>
<td>I&rsquo;m a teapot</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
          </div>
      </div>
    </div>
  </body>
</html>
